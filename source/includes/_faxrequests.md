# Fax Requests

## Post Fax Request

This call takes a FaxRequest JSON object (FaxRequestDTO) as input and does 3 things with it:

1.   First, it registers a new appointment in the database for the given patient at the given facility with an order status of "ORDERED", meaning the appointment has yet to be confirmed or scheduled.

2.   Second, it sends the fax order to the physician, patient, and/or claims administrator if indicated in the JSON object.

3.   Third, it starts sending the patient check-in emails through the email service Autopilot.

Finally, after these are done, it returns a response JSON object containing the fully updated fax request stored in the Stroll database.

```shell
curl --include \
     --header "Accept: application/vnd.sh-v1.0+json" \
     --header "Content-type: application/json" \
     --data "{ "sendFaxToFacility": false,
			 "currentFacilityId": 0,
			 "createDateAsString": "2000-00-00T00:00:00.000Z",
			 "patientEmail": "john@johndoe.com",
			 "cptCode": "51798",
			 "facilityFaxRequestType": 0,
			 "physicianFaxRequestType": 0,
			 "patientFaxRequestType": 0,
			 "patientFirstName": "John",
			 "referringPhysicianId": 0,
			 "patientId": 6209,
			 "patientLastName": "Doe",
			 "patientPhoneNumber": "(123) 456-7890",
			 "referringPhysicianName": "James Smith",
			 "sendFaxToPatient": false,
			 "sendFaxToPhysician": false,
			 "costsDTO": {},
			 "userId": 1,
			 "practiceId": 3,
			 "appointment_id": 301,
			 "faxDTO": 
			  { "member_ID": "",
			    "insurance_carrier": "Self",
			    "dob": "1980-01-01",
			    "facility_name": "Norcal Imaging San Leandro",
			    "facility_address_1": "2450 Washington Avenue",
			    "facility_address_2": "Suite 120",
			    "facility_address_3": "San Leandro, CA 94577",
			    "facility_phone": "(510) 351-7734",
			    "facility_fax": "(844) 787-6555",
			    "referral_ID": 1,
			    "patient_name": "John Doe",
			    "male_checkbox": true,
			    "female_checkbox": false,
			    "pregnant_checkbox": false,
			    "patient_phone_number": "(123) 456-7890",
			    "cell_checkbox": true,
			    "office_checkbox": false,
			    "home_checkbox": false,
			    "primary_language": "",
			    "estimate_out_of_pocket_cost": "$160.00",
			    "referring_physician_NPI": "123456",
			    "referring_physician_phone": "N/A",
			    "referring_physician_address": "null null Berkeley CA",
			    "referring_physician_fax": "(844) 787-6555",
			    "physician_portal_checkbox": false,
			    "physician_portal_url": "",
			    "fax_written_report_checkbox": false,
			    "fax_STAT_checkbox": false,
			    "phone_STAT_checkbox": false,
			    "phone_call_report_checkbox": false,
			    "send_CD_checkbox": false,
			    "send_patient_with_CD_checkbox": true,
			    "send_patient_with_films_checkbox": false,
			    "courier_films_checkbox": false,
			    "courier_films_to_name": "",
			    "courier_films_to_address": "",
			    "procedure_short_description": "Ultrasound Bladder, Post-Void",
			    "cpt_code": "51798",
			    "icd9_code": "",
			    "comparison_study_checkbox": false,
			    "clinical_indication": "this is a test",
			    "medication_provided_checkbox": false,
			    "medication_provided_description": "",
			    "special_instructions": "",
			    "previous_MRIMRA_checkbox": false,
			    "symptom_onset_date": "",
			    "claustrophobic_checkbox": false,
			    "pacemaker_checkbox": false,
			    "pacemaker_description": "",
			    "other_implanted_metal_checkbox": false,
			    "other_implanted_metal_description": "",
			    "contrast_allergy_checkbox": false,
			    "contrast_allergy_description": "",
			    "creatinine": "",
			    "oral_contrast_allergy_checkbox": false,
			    "oral_contrast_allergy_description": "",
			    "renal_disease_checkbox": false,
			    "diabetes_checkbox": false,
			    "other_allergies_checkbox": false,
			    "other_allergies_description": "",
			    "previous_MRIMRA_date": "",
			    "creatinine_date": "",
			    "taking_metformin_checkbox": false,
			    "referring_physician_name": "James Smith",
			    "referral_date": "2016-08-22",
			    "referring_physician_signature": "test",
			    "patientLastName": "Doe",
			    "patientFirstName": "John",
			    "patientEmail": "john@johndoe.com",
			    "userId": 1,
			    "practiceId": 3 } }" \
			    ```
  
> 'http://localhost:9090/sh/faxrequests'
> The above command returns JSON structured like this:

```json
{
  "meta": {
    "href": "/pendingFaxRequests/1684",
    "mediaType": "application/vnd.sh-v1.0+json"
  },
  "id": 1684,
  "faxRequestId": 1684,
  "appointment": {
    "meta": {
      "href": null,
      "mediaType": "application/vnd.sh-v1.0+json"
    },
    "appointmentId": 302,
    "equipmentId": 0,
    "patientId": 6209,
    "facilityId": 368,
    "faxRequestId": 1684,
    "startTime": 28800000,
    "endTime": 28800000,
    "cptCode": "51798",
    "cost": 160,
    "reasonNotYetScheduled": "N/A",
    "stillWantToSchedule": true,
    "orderStatus": null,
    "patientDTO": {
      "meta": {
        "href": "/patients/6209",
        "mediaType": "application/vnd.sh-v1.0+json"
      },
      "id": 6209,
      "autopilotContactId": "person_8BF27AF4-690E-426B-91F0-D6BF1C7B647D",
      "firstName": "John",
      "lastName": "Doe",
      "birthDate": "1980-01-01 00:00:00.0",
      "gender": "M",
      "email": "john@johndoe.com",
      "zip": "94109",
      "paySpecDTO": {
        "pi": "-1",
        "payerName": "Self",
        "mi": ""
      },
      "miInvalid": false,
      "rejectReason": null,
      "phoneNumber": "(123) 456-7890",
      "phoneNumberType": "Cell",
      "agreedToTerms": true,
      "termVersion": "1.0",
      "middleInitital": null
    }
  },
  "patientId": 6209,
  "userId": 1,
  "practiceId": 0,
  "patientLastName": "Doe",
  "patientFirstName": "John",
  "patientEmail": "john@johndoe.com",
  "patientPhoneNumber": "(123) 456-7890",
  "referringPhysicianName": "James Smith",
  "referringPhysicianId": -1,
  "currentFacilityId": -1,
  "currentFacilityName": null,
  "cptCode": "51798",
  "facilityFaxRequestType": 0,
  "patientFaxRequestType": 0,
  "physicianFaxRequestType": 0,
  "orderStatus": "AWAITING_SCHED",
  "productionPatientPortal": null,
  "sendFaxToFacility": false,
  "sendFaxToPatient": false,
  "sendFaxToPhysician": false,
  "patientFaxStatus": "PENDING",
  "physicianFaxStatus": "PENDING",
  "facilityFaxStatus": "PENDING",
  "lastUpdateDate": 1471909348440,
  "createDate": 1471909348440,
  "createDateAsString": "08-22-2016",
  "faxDTO": {
    "meta": {
      "href": null,
      "mediaType": "application/vnd.sh-v1.0+json"
    },
    "cash_alert": null,
    "mammogram": null,
    "facility_fax": "(844) 787-6555",
    "referring_physician_fax": "(844) 787-6555",
    "referring_physician_NPI": "123456",
    "referring_physician_name": "James Smith",
    "facility_name": "Norcal Imaging San Leandro",
    "referring_physician_phone": "N/A",
    "insurance_carrier": "Self",
    "estimate_out_of_pocket_cost": "$160.00",
    "cpt_code": "51798",
    "plan": null,
    "send_CD_checkbox": false,
    "send_patient_with_CD_checkbox": true,
    "send_films_checkbox": false,
    "send_patient_with_films_checkbox": false,
    "courier_films_checkbox": false,
    "courier_films_to_name": "",
    "courier_films_to_address": "",
    "procedure_short_description": "Ultrasound Bladder, Post-Void",
    "icd10_code": null,
    "comparison_study_checkbox": false,
    "clinical_indication": "this is a test",
    "special_instructions": "",
    "medication_provided_checkbox": false,
    "medication_provided_description": "",
    "procedure_locations": null,
    "previous_MRIMRA_checkbox": false,
    "symptom_onset_date": "",
    "claustrophobic_checkbox": false,
    "pacemaker_checkbox": false,
    "pacemaker_description": "",
    "other_implanted_metal_checkbox": false,
    "other_implanted_metal_description": "",
    "iv_contrast_allergy_checkbox": false,
    "creatinine": "",
    "iv_contrast_allergy_description": null,
    "oral_contrast_allergy_checkbox": false,
    "oral_contrast_allergy_description": "",
    "renal_disease_checkbox": false,
    "diabetes_checkbox": false,
    "other_allergies_checkbox": false,
    "other_allergies_description": "",
    "previous_MRIMRA_date": "",
    "creatinine_date": "",
    "taking_metformin_checkbox": false,
    "referral_date": "2016-08-22",
    "referring_physician_signature": "test",
    "eligibility_validated_checkbox": false,
    "dob": "1980-01-01",
    "facility_address_1": "2450 Washington Avenue",
    "facility_address_2": "Suite 120",
    "facility_address_3": "San Leandro, CA 94577",
    "facility_phone": "(510) 351-7734",
    "referral_ID": "1",
    "patient_name": "John Doe",
    "male_checkbox": true,
    "female_checkbox": false,
    "pregnant_checkbox": false,
    "patient_phone_number": "(123) 456-7890",
    "cell_checkbox": true,
    "office_checkbox": false,
    "home_checkbox": false,
    "primary_language": "",
    "member_ID": "",
    "verified_eligibility_date": "N/A",
    "received_prior_auth_checkbox": false,
    "prior_auth_number": "N/A",
    "good_until_date": "N/A",
    "service_type": null,
    "in_network_copay": "N/A",
    "in_network_coinsurance": "N/A",
    "in_network_single_maximum_total": "N/A",
    "in_network_single_maximum_remaining": "N/A",
    "in_network_single_deductible_total": "N/A",
    "in_network_single_deductible_remaining": "N/A",
    "in_network_family_maximum_total": "N/A",
    "in_network_family_maximum_remaining": "N/A",
    "in_network_family_deductible_total": "N/A",
    "in_network_family_deductible_remaining": "N/A",
    "out_network_copay": "N/A",
    "out_network_coinsurance": "N/A",
    "out_network_single_maximum_remaining": "N/A",
    "out_network_single_deductible_remaining": "N/A",
    "out_network_single_deductible_total": "N/A",
    "out_network_single_maximum_total": "N/A",
    "out_network_family_maximum_total": "N/A",
    "out_network_family_maximum_remaining": "N/A",
    "out_network_family_deductible_total": "N/A",
    "out_network_family_deductible_remaining": "N/A",
    "referring_physician_address": "null null Berkeley CA",
    "physician_portal_checkbox": false,
    "physician_portal_url": "",
    "fax_written_report_checkbox": false,
    "fax_STAT_checkbox": false,
    "phone_STAT_checkbox": false,
    "phone_call_report_checkbox": false
  },
  "costsDTO": {
    "meta": {
      "href": null,
      "mediaType": "application/vnd.sh-v1.0+json"
    },
    "costDTOs": [],
    "insuranceDTO": {
      "patientId": null,
      "serviceType": null,
      "deductDate": null,
      "plan": null,
      "payerId": null,
      "payer": null,
      "inIndividDeductTotal": 0,
      "outIndividDeductTotal": 0,
      "inIndividDeductRemain": 0,
      "outIndividDeductRemain": 0,
      "inFamilyDeductTotal": 0,
      "outFamilyDeductTotal": 0,
      "inFamilyDeductRemain": 0,
      "outFamilyDeductRemain": 0,
      "inIndividMaxTotal": 0,
      "outIndividMaxTotal": 0,
      "inIndividMaxRemain": 0,
      "outIndividMaxRemain": 0,
      "inFamilyMaxTotal": 0,
      "outFamilyMaxTotal": 0,
      "inFamilyMaxRemain": 0,
      "outFamilyMaxRemain": 0,
      "incopay": 0,
      "incopayOutpatient": 0,
      "outcopay": 0,
      "incoinsurance": 0,
      "outcoinsurance": 0,
      "tier1Deduct": 0,
      "tier1FamilyDeduct": 0,
      "tier1Remain": 0,
      "tier1FamilyRemain": 0,
      "tier1MaxDeduct": 0,
      "tier1FamilyMaxDeduct": 0,
      "tier1MaxRemain": 0,
      "tier1FamilyMaxRemain": 0,
      "tier1Copay": 0,
      "tier1Coinsurance": 0
    },
    "notes": null
  },
  "rfaPhysicianFaxRequestType": "0",
  "pr2PhysicianFaxRequestType": "0",
  "pr2FaxDTO": null,
  "rfaFaxDTO": null,
  "imageDTO": {
    "meta": {
      "href": null,
      "mediaType": "application/vnd.sh-v1.0+json"
    },
    "encodedImage": "",
    "minWidth": 1225,
    "minHeight": 1585
  },
  "partner": null,
  "chosenFacilityId": null,
  "appointmentStart": null,
  "appointmentEnd": null,
  "sendFaxToClaimsAdministrator": false,
  "sendFaxToClaimsAdministratorCompany": false
}
```
### HTTP Request

`POST http://localhost:9090/sh/faxrequests`
